<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>é—‡å½±è©©ç« ï¼šå‡Œè¶Šä¸–ç•Œ (Shadowverse: Worlds Beyond) - å°æˆ°ç´€éŒ„APP</title>
    <link rel="stylesheet" href="src/css/styles.css">
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>ğŸƒ é—‡å½±è©©ç« ï¼šå‡Œè¶Šä¸–ç•Œ (Shadowverse: Worlds Beyond)</h1>
            <p>å°æˆ°ç´€éŒ„è¿½è¹¤ç³»çµ±</p>
            
            <!-- å°èˆªé¸å–® -->
            <div class="nav-menu">
                <button class="nav-btn active" onclick="showPanel('stats')">ğŸ“Š å°æˆ°çµ±è¨ˆ</button>
                <button class="nav-btn" onclick="showPanel('matrix')">ğŸ¯ å°æˆ°çŸ©é™£</button>
                <button class="nav-btn" onclick="showPanel('player')">ğŸ‘¤ ç©å®¶è³‡æ–™</button>
                <button class="nav-btn" onclick="showPanel('battle')">âš”ï¸ å°æˆ°è¨˜éŒ„</button>
                <button class="nav-btn" onclick="showPanel('settings')">âš™ï¸ è¨­å®šåŒ¯å…¥</button>
            </div>
        </div>
        
        <!-- å°æˆ°çµ±è¨ˆé¢æ¿ -->
        <div id="statsPanel" class="panel active">
            <div class="stats-panel">
                <div class="stat-card">
                    <div class="stat-title">èµ·å§‹åˆ†çµ„</div>
                    <div class="stat-value" id="currentRank" style="cursor: pointer; transition: all 0.3s; font-size: 20px;" onclick="editCurrentRank()"></div>
                    <small style="color: #ccc; font-size: 12px;">é»æ“Šç·¨è¼¯</small>
                </div>
                <div class="stat-card">
                    <div class="stat-title">èµ·å§‹BP</div>
                    <div class="stat-value" id="startingBP" style="cursor: pointer; transition: all 0.3s;" onclick="editStartingBP()">43945</div>
                    <small style="color: #ccc; font-size: 12px;">é»æ“Šç·¨è¼¯</small>
                </div>
                <div class="stat-card">
                    <div class="stat-title">ç›®å‰BP</div>
                    <div class="stat-value" id="currentBP">45427</div>
                </div>
                <div class="stat-card">
                    <div class="stat-title">ç›®å‰éšç´š</div>
                    <div class="stat-value" id="currentRankLevel">A1</div>
                </div>
                <div class="stat-card">
                    <div class="stat-title">ç¸½å°æˆ°å ´æ•¸</div>
                    <div class="stat-value" id="totalGames">10</div>
                </div>
                <div class="stat-card">
                    <div class="stat-title">ç¸½å‹ç‡</div>
                    <div class="stat-value" id="winRate">60%</div>
                </div>
                <div class="stat-card">
                    <div class="stat-title">å…ˆæ‰‹å‹ç‡</div>
                    <div class="stat-value" id="firstWinRate">--</div>
                </div>
                <div class="stat-card">
                    <div class="stat-title">å¾Œæ‰‹å‹ç‡</div>
                    <div class="stat-value" id="secondWinRate">--</div>
                </div>
                <div class="stat-card">
                    <div class="stat-title">é€£å‹/é€£æ•—</div>
                    <div class="stat-value" id="streak">1æ•—</div>
                </div>
            </div>
            
            <div class="rank-calculator">
                <h3 style="color: #ffd700; margin-bottom: 20px;">ğŸ† åˆ†çµ„å‡é™è¨ˆç®—å™¨</h3>
                <div class="rank-info">
                    <div class="rank-card" style="border-left: 8px solid #4caf50;">
                        <div class="rank-title">ğŸŸ¢ ç¶ å¯¶çŸ³åˆ†çµ„ <span style='color:#4caf50'>(x1.0)</span></div>
                        <div class="rank-requirement">â€¢ æ–°æ‰‹åˆ†çµ„<br>â€¢ å‡ç´šæ¢ä»¶ï¼šé”åˆ°ä¸€å®šBPè‡ªå‹•å‡ç´š<br>â€¢ å‹ç‡ç„¡å£“åŠ›ï¼Œå€ç‡x1.0</div>
                    </div>
                    <div class="rank-card" style="border-left: 8px solid #ffb300;">
                        <div class="rank-title">ğŸŸ  é»ƒå¯¶çŸ³åˆ†çµ„ <span style='color:#ffb300'>(x1.1)</span></div>
                        <div class="rank-requirement">â€¢ é€²éšåˆ†çµ„<br>â€¢ å‡ç´šæ¢ä»¶ï¼šBPé”æ¨™è‡ªå‹•å‡ç´š<br>â€¢ å‹ç‡å»ºè­°45%ä»¥ä¸Šï¼Œå€ç‡x1.1</div>
                    </div>
                    <div class="rank-card" style="border-left: 8px solid #e53935;">
                        <div class="rank-title">ğŸ”´ ç´…å¯¶çŸ³åˆ†çµ„ <span style='color:#e53935'>(x1.3)</span></div>
                        <div class="rank-requirement">â€¢ ä¸­é«˜ç´šåˆ†çµ„<br>â€¢ å‡ç´šæ¢ä»¶ï¼šBPé”æ¨™è‡ªå‹•å‡ç´š<br>â€¢ å‹ç‡å»ºè­°50%ä»¥ä¸Šï¼Œå€ç‡x1.3</div>
                    </div>
                    <div class="rank-card" style="border-left: 8px solid #1e88e5;">
                        <div class="rank-title">ğŸ”µ è—å¯¶çŸ³åˆ†çµ„ <span style='color:#1e88e5'>(x1.5)</span></div>
                        <div class="rank-requirement">â€¢ é«˜ç´šåˆ†çµ„<br>â€¢ å‡ç´šæ¢ä»¶ï¼šBPé”æ¨™è‡ªå‹•å‡ç´š<br>â€¢ å‹ç‡å»ºè­°55%ä»¥ä¸Šï¼Œå€ç‡x1.5</div>
                    </div>
                    <div class="rank-card" style="border-left: 8px solid #b39ddb;">
                        <div class="rank-title">ğŸ’ é‘½çŸ³åˆ†çµ„ <span style='color:#b39ddb'>(x2.0)</span></div>
                        <div class="rank-requirement">â€¢ æœ€é«˜åˆ†çµ„<br>â€¢ ç¶­æŒæ¢ä»¶ï¼šå‹ç‡60%ä»¥ä¸Š<br>â€¢ ä½æ–¼50%æœ‰æ‰ç´šé¢¨éšªï¼Œå€ç‡x2.0</div>
                    </div>
                </div>
                
                <div class="rank-status">
                    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px;">
                        <span><strong>ç›®å‰ç‹€æ…‹åˆ†æï¼š</strong></span>
                        <span id="rankStatusText" class="rank-safe">âœ… åˆ†çµ„å®‰å…¨</span>
                    </div>
                    
                    <div class="progress-bar">
                        <div class="progress-fill" id="rankProgress" style="width: 60%"></div>
                    </div>
                    
                    <div id="rankAnalysis" style="color: #ccc; font-size: 14px; margin-top: 10px;">
                        æ ¹æ“šæ‚¨ç›®å‰60%çš„å‹ç‡ï¼Œåœ¨é‘½çŸ³åˆ†çµ„ä¸­è¡¨ç¾è‰¯å¥½ï¼Œå»ºè­°ç¹¼çºŒä¿æŒã€‚
                    </div>
                    
                    <div id="rankPrediction" style="color: #ffa726; font-size: 14px; margin-top: 10px;">
                        â€¢ å¦‚æœæ¥ä¸‹ä¾†5å ´å…¨æ•—ï¼Œå‹ç‡å°‡é™è‡³46%ï¼Œæœ‰æ‰ç´šé¢¨éšª<br>
                        â€¢ å¦‚æœæ¥ä¸‹ä¾†5å ´å…¨å‹ï¼Œå‹ç‡å°‡å‡è‡³71%ï¼Œåˆ†çµ„éå¸¸ç©©å®š
                    </div>
                </div>
            </div>
        </div>
        
        <!-- å°æˆ°çŸ©é™£é¢æ¿ -->
        <div id="matrixPanel" class="panel">
            <div class="matrix-container">
                <h2 style="color: #ffd700; text-align: center; margin-bottom: 30px;">ğŸ¯ è·æ¥­å°æˆ°å‹ç‡çŸ©é™£</h2>
                
                <!-- çŸ©é™£åˆ‡æ›æŒ‰éˆ• -->
                <div class="matrix-toggle">
                    <button class="matrix-btn active" onclick="showMatrixType('first')" id="firstMatrixBtn">ğŸ”´ å…ˆæ‰‹å‹ç‡çŸ©é™£</button>
                    <button class="matrix-btn" onclick="showMatrixType('second')" id="secondMatrixBtn">ğŸ”µ å¾Œæ‰‹å‹ç‡çŸ©é™£</button>
                </div>
                
                <!-- å…ˆæ‰‹å‹ç‡çŸ©é™£ -->
                <div id="firstMatrix" class="matrix-table-container active">
                    <h3 style="color: #FF6B6B; text-align: center; margin-bottom: 20px;">ğŸ”´ å…ˆæ‰‹å‹ç‡çŸ©é™£</h3>
                    <div class="matrix-table" id="firstMatrixTable">
                        <!-- å…ˆæ‰‹çŸ©é™£è¡¨æ ¼å°‡åœ¨æ­¤å‹•æ…‹ç”Ÿæˆ -->
                    </div>
                    <div class="matrix-stats" id="firstMatrixStats">
                        <!-- å…ˆæ‰‹çµ±è¨ˆå°‡åœ¨æ­¤é¡¯ç¤º -->
                    </div>
                </div>
                
                <!-- å¾Œæ‰‹å‹ç‡çŸ©é™£ -->
                <div id="secondMatrix" class="matrix-table-container">
                    <h3 style="color: #4ECDC4; text-align: center; margin-bottom: 20px;">ğŸ”µ å¾Œæ‰‹å‹ç‡çŸ©é™£</h3>
                    <div class="matrix-table" id="secondMatrixTable">
                        <!-- å¾Œæ‰‹çŸ©é™£è¡¨æ ¼å°‡åœ¨æ­¤å‹•æ…‹ç”Ÿæˆ -->
                    </div>
                    <div class="matrix-stats" id="secondMatrixStats">
                        <!-- å¾Œæ‰‹çµ±è¨ˆå°‡åœ¨æ­¤é¡¯ç¤º -->
                    </div>
                </div>
                
                <!-- çŸ©é™£èªªæ˜ -->
                <div class="matrix-info">
                    <h4 style="color: #ffd700; margin-bottom: 15px;">ğŸ“‹ ä½¿ç”¨èªªæ˜</h4>
                    <ul style="color: #ccc; line-height: 1.6;">
                        <li><strong>ç¸±è»¸ï¼ˆå·¦å´ï¼‰</strong>ï¼šæ‚¨ä½¿ç”¨çš„è·æ¥­</li>
                        <li><strong>æ©«è»¸ï¼ˆä¸Šæ–¹ï¼‰</strong>ï¼šå°æ‰‹ä½¿ç”¨çš„è·æ¥­</li>
                        <li><strong>æ•¸å€¼</strong>ï¼šè©²çµ„åˆçš„å‹ç‡ç™¾åˆ†æ¯”</li>
                        <li><strong>é¡è‰²</strong>ï¼š
                            <span style="color: #4CAF50;">ç¶ è‰²</span> = é«˜å‹ç‡ (â‰¥70%), 
                            <span style="color: #FFC107;">é»ƒè‰²</span> = ä¸­ç­‰å‹ç‡ (50-69%), 
                            <span style="color: #F44336;">ç´…è‰²</span> = ä½å‹ç‡ (<50%)
                        </li>
                        <li><strong>--</strong>ï¼šè¡¨ç¤ºè©²çµ„åˆå°šç„¡å°æˆ°æ•¸æ“š</li>
                    </ul>
                </div>
            </div>
        </div>
        
        <!-- ç©å®¶è³‡æ–™é¢æ¿ -->
        <div id="playerPanel" class="panel">
            <div class="player-profile">
                <div class="profile-section">
                    <h3>ğŸ‘¤ åŸºæœ¬è³‡æ–™</h3>
                    <div class="profile-grid">
                        <div class="profile-item">
                            <div class="profile-label">ç©å®¶åç¨±</div>
                            <div class="profile-value editable" id="playerName" onclick="editPlayerName()">æœªè¨­å®š</div>
                        </div>
                        <div class="profile-item">
                            <div class="profile-label">éŠæˆ²ID</div>
                            <div class="profile-value editable" id="gameId" onclick="editGameId()">æœªè¨­å®š</div>
                        </div>
                        <div class="profile-item">
                            <div class="profile-label">è¨»å†Šæ—¥æœŸ</div>
                            <div class="profile-value" id="registerDate">2025-06-29</div>
                        </div>
                        <div class="profile-item">
                            <div class="profile-label">ä¸»è¦è·æ¥­</div>
                            <div class="profile-value editable" id="mainClass" onclick="editMainClass()">é¾</div>
                        </div>
                    </div>
                </div>
                
                <div class="profile-section">
                    <h3>ğŸ¯ éŠæˆ²ç›®æ¨™</h3>
                    <div class="profile-grid">
                        <div class="profile-item">
                            <div class="profile-label">ç›®æ¨™åˆ†çµ„</div>
                            <div class="profile-value editable" id="targetRank" onclick="editTargetRank()">é‘½çŸ³</div>
                        </div>
                        <div class="profile-item">
                            <div class="profile-label">ç›®æ¨™å‹ç‡</div>
                            <div class="profile-value" id="targetWinRate">70%</div>
                        </div>
                        <div class="profile-item">
                            <div class="profile-label">æœˆç›®æ¨™å ´æ•¸</div>
                            <div class="profile-value" id="monthlyTarget">100å ´</div>
                        </div>
                        <div class="profile-item">
                            <div class="profile-label">ç›®æ¨™BP</div>
                            <div class="profile-value" id="targetBP">60000</div>
                        </div>
                    </div>
                </div>
                
                <div class="profile-section">
                    <h3>ğŸ“Š æ­·å²ç´€éŒ„</h3>
                    <div class="profile-grid">
                        <div class="profile-item">
                            <div class="profile-label">æœ€é«˜åˆ†çµ„</div>
                            <div class="profile-value" id="highestRank">é‘½çŸ³</div>
                        </div>
                        <div class="profile-item">
                            <div class="profile-label">æœ€é«˜BP</div>
                            <div class="profile-value" id="highestBP">52000</div>
                        </div>
                        <div class="profile-item">
                            <div class="profile-label">æœ€é•·é€£å‹</div>
                            <div class="profile-value" id="longestWinStreak">8å ´</div>
                        </div>
                        <div class="profile-item">
                            <div class="profile-label">ç¸½éŠæˆ²æ™‚é–“</div>
                            <div class="profile-value" id="totalPlayTime">45å°æ™‚</div>
                        </div>
                    </div>
                </div>
                
                <!-- ä¿å­˜æ“ä½œå€åŸŸ -->
                <div class="profile-section">
                    <h3>ğŸ’¾ è³‡æ–™ç®¡ç†</h3>
                    <div style="display: flex; gap: 10px; margin-top: 15px; flex-wrap: wrap;">
                        <button class="btn" onclick="savePlayerProfile()" style="background: #4caf50;">
                            ğŸ’¾ ä¿å­˜è³‡æ–™
                        </button>
                        <button class="btn" onclick="resetPlayerProfile()" style="background: #ff9800;">
                            ğŸ”„ é‡ç½®è³‡æ–™
                        </button>
                        <button class="btn" onclick="exportPlayerProfile()" style="background: #2196f3;">
                            ğŸ“¤ åŒ¯å‡ºè³‡æ–™
                        </button>
                        <button class="btn" onclick="exportRankChangeAnalysis()" style="background: #9c27b0;">
                            ğŸ“Š åŒ¯å‡ºåˆ†çµ„è®Šå‹•åˆ†æ
                        </button>
                    </div>
                    <div id="saveStatus" style="margin-top: 10px; color: #4caf50; font-size: 14px; display: none;">
                        âœ… è³‡æ–™å·²ä¿å­˜
                    </div>
                </div>
            </div>
        </div>
        
        <!-- å°æˆ°è¨˜éŒ„é¢æ¿ -->
        <div id="battlePanel" class="panel">
            <div class="battle-form">
                <h3 style="color: #ffd700; margin-bottom: 20px;">âš”ï¸ æ–°å¢å°æˆ°è¨˜éŒ„</h3>
                
                <div class="form-row">
                    <div class="form-group">
                        <label for="myClass">æˆ‘çš„è·æ¥­</label>
                        <select id="myClass">
                            <option value="çš‡å®¶">çš‡å®¶</option>
                            <option value="ç²¾éˆ">ç²¾éˆ</option>
                            <option value="å·«å¸«">å·«å¸«</option>
                            <option value="é¾" selected>é¾</option>
                            <option value="å¤œé­”">å¤œé­”</option>
                            <option value="ä¸»æ•™">ä¸»æ•™</option>
                            <option value="å¾©ä»‡è€…">å¾©ä»‡è€…</option>
                        </select>
                    </div>
                    
                    <div class="form-group">
                        <label for="opponentClass">å°æ‰‹è·æ¥­</label>
                        <select id="opponentClass">
                            <option value="çš‡å®¶">çš‡å®¶</option>
                            <option value="ç²¾éˆ">ç²¾éˆ</option>
                            <option value="å·«å¸«">å·«å¸«</option>
                            <option value="é¾">é¾</option>
                            <option value="å¤œé­”">å¤œé­”</option>
                            <option value="ä¸»æ•™">ä¸»æ•™</option>
                            <option value="å¾©ä»‡è€…">å¾©ä»‡è€…</option>
                        </select>
                    </div>
                    
                    <div class="form-group">
                        <label for="turnOrder">å…ˆå¾Œæ‰‹</label>
                        <select id="turnOrder">
                            <option value="">è«‹é¸æ“‡</option>
                            <option value="å…ˆæ‰‹">å…ˆæ‰‹</option>
                            <option value="å¾Œæ‰‹">å¾Œæ‰‹</option>
                        </select>
                    </div>
                </div>
                
                <div class="form-row">
                    <div class="form-group">
                        <label for="result">å°æˆ°çµæœ</label>
                        <select id="result">
                            <option value="">è«‹é¸æ“‡</option>
                            <option value="å‹">å‹åˆ©</option>
                            <option value="æ•—">æ•—åŒ—</option>
                        </select>
                    </div>
                    
                    <div class="form-group" style="grid-column: span 2;">
                        <label for="bpChange">BPè®ŠåŒ– <span style="color: #4CAF50; font-size: 12px;">ğŸ’¡ è¼¸å…¥å®Œæˆå¾ŒæŒ‰ Enter éµæäº¤</span></label>
                        <input type="number" id="bpChange" placeholder="å»ºè­°å€¼: +320" min="0" title="è¼¸å…¥BPè®ŠåŒ–å€¼ï¼ŒæŒ‰Enteréµæäº¤å°æˆ°è¨˜éŒ„">
                    </div>
                </div>
                
                <!-- ç§»é™¤æŒ‰éˆ•ï¼Œæ”¹ç”¨ Enter éµæäº¤ -->
                <div style="text-align: center; padding: 15px; background: rgba(76, 175, 80, 0.1); border-radius: 8px; margin: 10px 0;">
                    <span style="color: #4CAF50; font-size: 14px;">âŒ¨ï¸ å¡«å¯«å®Œæ‰€æœ‰æ¬„ä½å¾Œï¼Œåœ¨ BP è¼¸å…¥æ¡†æŒ‰ <kbd style="background: #333; color: #fff; padding: 3px 6px; border-radius: 3px;">Enter</kbd> éµå³å¯æ–°å¢å°æˆ°è¨˜éŒ„</span>
                </div>
            </div>
            
            <div class="battle-history">
                <h3 style="color: #ffd700; padding: 20px; margin: 0;">ğŸ“‹ å°æˆ°æ­·å²</h3>
                <div id="battleList"></div>
            </div>
            
            <div style="display: flex; gap: 10px; margin-top: 20px;">
                <button class="btn export-btn" onclick="exportData()">ğŸ“¥ åŒ¯å‡ºæ•¸æ“š</button>
                <button class="btn clear-btn" onclick="clearAllData()">ğŸ—‘ï¸ æ¸…é™¤æ•¸æ“š</button>
            </div>
        </div>
        
        <!-- è¨­å®šåŒ¯å…¥é¢æ¿ -->
        <div id="settingsPanel" class="panel">
            <div class="import-area" id="importArea" onclick="document.getElementById('fileInput').click();">
                <p>ğŸ“ é»æ“Šæ­¤è™•é¸æ“‡æª”æ¡ˆæˆ–æ‹–æ”¾æ–‡å­—æª”æ¡ˆé€²è¡ŒåŒ¯å…¥</p>
                <p style="color: #ccc; font-size: 14px;">æ”¯æ´æ ¼å¼ï¼š.txt æ–‡å­—æª”æ¡ˆ</p>
                <input type="file" id="fileInput" class="file-input" accept=".txt" onchange="importFromFile(event)">
            </div>
            
            <!-- æ”¯æŒé–‹ç™¼è€…å€æ®µ -->
            <div style="margin-top: 30px; padding: 25px; background: linear-gradient(135deg, rgba(103, 126, 234, 0.1) 0%, rgba(118, 75, 162, 0.1) 100%); border-radius: 15px; border: 2px solid rgba(255, 215, 0, 0.3);">
                <h3 style="color: #ffd700; margin: 0 0 20px 0; text-align: center;">ğŸ’ æ”¯æŒé–‹ç™¼è€…</h3>
                
                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin-bottom: 20px;">
                    <div style="text-align: center; padding: 15px; background: rgba(255,255,255,0.05); border-radius: 10px;">
                        <h4 style="color: #64b5f6; margin: 0 0 10px 0;">ğŸ ææ¬¾æ–—å…§</h4>
                        <p style="margin: 5px 0; font-size: 14px;">è¡—å£æ”¯ä»˜: <strong>901013711</strong></p>
                        <p style="margin: 5px 0; font-size: 14px;">LINE Pay: <strong>901013711</strong></p>
                        <p style="margin: 5px 0; font-size: 14px;">æ‚ éŠä»˜: <strong>H0975975251</strong></p>
                    </div>
                    
                    <div style="text-align: center; padding: 15px; background: rgba(255,255,255,0.05); border-radius: 10px;">
                        <h4 style="color: #64b5f6; margin: 0 0 10px 0;">â­ å…¶ä»–æ”¯æŒ</h4>
                        <p style="margin: 5px 0; font-size: 14px;">
                            <a href="https://github.com/xiujiang1987/shadowverse-worlds-beyond-tracker" target="_blank" style="color: #64b5f6; text-decoration: none;">
                                ğŸŒŸ GitHub Star
                            </a>
                        </p>
                        <p style="margin: 5px 0; font-size: 14px;">
                            <a href="https://github.com/xiujiang1987/shadowverse-worlds-beyond-tracker/issues" target="_blank" style="color: #64b5f6; text-decoration: none;">
                                ğŸ› å›å ±å•é¡Œ
                            </a>
                        </p>
                        <p style="margin: 5px 0; font-size: 14px;">ğŸ“¢ æ¨è–¦çµ¦æœ‹å‹</p>
                    </div>
                </div>
                
                <div style="text-align: center; padding: 15px; background: rgba(255,255,255,0.03); border-radius: 10px;">
                    <p style="margin: 0; font-size: 13px; color: #ccc;">
                        ğŸ’• æ„Ÿè¬æ‚¨çš„æ”¯æŒï¼æ¯ä¸€ä»½ææ¬¾å’Œå›é¥‹éƒ½æ˜¯æŒçºŒé–‹ç™¼çš„å‹•åŠ›
                    </p>
                    <p style="margin: 8px 0 0 0; font-size: 12px; color: #999;">
                        ğŸ™ è®“æˆ‘å€‘ä¸€èµ·ç‚º Shadowverse ç¤¾ç¾¤æä¾›æ›´å¥½çš„å·¥å…·
                    </p>
                </div>
            </div>
        </div>
    </div>

    <!-- JavaScript æ¨¡çµ„ -->
    <script src="src/js/config.js"></script>
    <script src="src/js/data-manager.js"></script>
    <script src="src/js/rank-manager.js"></script>
    <script src="src/js/ui-controller.js"></script>
    
    <!-- åˆå§‹åŒ–è…³æœ¬ -->
    <script>
        // å…¨åŸŸè®Šæ•¸è²æ˜
        let dataManager;
        let uiController;
        
        // ç¢ºä¿æ‰€æœ‰æ¨¡çµ„è¼‰å…¥å¾Œå†åˆå§‹åŒ–
        document.addEventListener('DOMContentLoaded', function() {
            console.log('ğŸš€ é–‹å§‹åˆå§‹åŒ–æ‡‰ç”¨ç¨‹å¼...');
            
            try {
                // æª¢æŸ¥ä¾è³´
                if (typeof CONFIG === 'undefined') {
                    throw new Error('CONFIG æœªè¼‰å…¥');
                }
                if (typeof DataManager === 'undefined') {
                    throw new Error('DataManager é¡åˆ¥æœªè¼‰å…¥');
                }
                if (typeof UIController === 'undefined') {
                    throw new Error('UIController é¡åˆ¥æœªè¼‰å…¥');
                }
                
                console.log('âœ… æ‰€æœ‰ä¾è³´å·²è¼‰å…¥');
                
                // åˆå§‹åŒ– DataManager
                dataManager = new DataManager();
                console.log('âœ… DataManager åˆå§‹åŒ–æˆåŠŸ');
                
                // åˆå§‹åŒ– UIController
                uiController = new UIController();
                console.log('âœ… UIController åˆå§‹åŒ–æˆåŠŸ');
                
                // è¨­å®šé è¨­é¢æ¿
                setTimeout(() => {
                    if (uiController && typeof uiController.showPanel === 'function') {
                        uiController.showPanel('stats');
                        console.log('âœ… é è¨­é¢æ¿è¨­å®šå®Œæˆ');
                    }
                }, 100);
                
                console.log('ğŸ‰ æ‡‰ç”¨ç¨‹å¼åˆå§‹åŒ–å®Œæˆï¼');
                
            } catch (error) {
                console.error('âŒ æ‡‰ç”¨ç¨‹å¼åˆå§‹åŒ–å¤±æ•—:', error);
                document.body.innerHTML = `
                    <div style="padding: 20px; text-align: center; color: #f44336; background: #1a1a2e; min-height: 100vh;">
                        <h1>ğŸš« æ‡‰ç”¨ç¨‹å¼åˆå§‹åŒ–å¤±æ•—</h1>
                        <p><strong>éŒ¯èª¤:</strong> ${error.message}</p>
                        <p>è«‹æª¢æŸ¥ç€è¦½å™¨æ§åˆ¶å°ç²å–è©³ç´°è³‡è¨Šã€‚</p>
                        <button onclick="window.location.reload()" style="padding: 10px 20px; margin: 10px; background: #2196f3; color: white; border: none; border-radius: 5px; cursor: pointer;">
                            é‡æ–°è¼‰å…¥é é¢
                        </button>
                        <button onclick="window.open('diagnostic.html', '_blank')" style="padding: 10px 20px; margin: 10px; background: #ff9800; color: white; border: none; border-radius: 5px; cursor: pointer;">
                            é–‹å•Ÿè¨ºæ–·é é¢
                        </button>
                    </div>
                `;
            }
        });
        
        // å…¨åŸŸå‡½æ•¸ (ä¾› HTML onclick ä½¿ç”¨)
        function showPanel(panelName) {
            console.log('showPanel è¢«èª¿ç”¨:', panelName);
            if (uiController && typeof uiController.showPanel === 'function') {
                uiController.showPanel(panelName);
            } else {
                console.error('uiController å°šæœªåˆå§‹åŒ–æˆ– showPanel æ–¹æ³•ä¸å­˜åœ¨');
                alert('ç³»çµ±å°šæœªå®Œå…¨è¼‰å…¥ï¼Œè«‹ç¨å€™å†è©¦');
            }
        }
        
        function addBattle() {
            if (uiController && typeof uiController.addBattle === 'function') {
                uiController.addBattle();
            } else {
                console.error('uiController å°šæœªåˆå§‹åŒ–');
            }
        }
        
        function clearAllData() {
            if (uiController && typeof uiController.clearAllData === 'function') {
                uiController.clearAllData();
            } else {
                console.error('uiController å°šæœªåˆå§‹åŒ–');
            }
        }
        
        function exportData() {
            if (uiController && typeof uiController.exportData === 'function') {
                uiController.exportData();
            } else {
                console.error('uiController å°šæœªåˆå§‹åŒ–');
            }
        }
        
        function importFromFile(event) {
            if (uiController && typeof uiController.importFromFile === 'function') {
                uiController.importFromFile(event);
            } else {
                console.error('uiController å°šæœªåˆå§‹åŒ–');
            }
        }
        
        // å…¶ä»–å¿…è¦çš„å…¨åŸŸå‡½æ•¸
        function editStartingBP() {
            if (uiController) uiController.editStartingBP();
        }
        
        function editCurrentRank() {
            if (uiController) uiController.editCurrentRank();
        }
        
        function editPlayerName() {
            if (uiController) uiController.editPlayerName();
        }
        
        function editGameId() {
            if (uiController) uiController.editGameId();
        }
        
        function savePlayerProfile() {
            if (uiController) uiController.savePlayerProfile();
        }
        
        function resetPlayerProfile() {
            if (uiController) uiController.resetPlayerProfile();
        }
        
        function exportPlayerProfile() {
            if (uiController) uiController.exportPlayerProfile();
        }
        
        function showMatrixType(type) {
            if (uiController) uiController.showMatrixType(type);
        }
        
        function toggleRankChange(battleIndex, battleId) {
            if (uiController) uiController.toggleRankChange(battleIndex, battleId);
        }
        
        function confirmRankChange(battleIndex, battleId) {
            if (uiController) uiController.confirmRankChange(battleIndex, battleId);
        }
        
        function editBattle(battleId) {
            if (uiController) uiController.editBattle(battleId);
        }
        
        function deleteBattle(battleId) {
            if (uiController) uiController.deleteBattle(battleId);
        }
        
        function saveEditBattle(battleId) {
            if (uiController) uiController.saveEditBattle(battleId);
        }
    </script>
</body>
</html>
