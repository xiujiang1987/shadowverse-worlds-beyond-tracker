<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>åŠŸèƒ½æ¸¬è©¦ - Shadowverse Tracker</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            padding: 20px;
            background: #1a1a2e;
            color: white;
        }
        .test-section {
            margin: 20px 0;
            padding: 15px;
            border: 1px solid #ccc;
            border-radius: 5px;
            background: rgba(255,255,255,0.1);
        }
        button {
            padding: 10px 20px;
            margin: 5px;
            background: #2196f3;
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-size: 14px;
        }
        button:hover {
            background: #1976d2;
        }
        .success { color: #4caf50; }
        .error { color: #f44336; }
        .warning { color: #ff9800; }
        .log {
            background: #000;
            padding: 10px;
            border-radius: 5px;
            margin: 10px 0;
            font-family: monospace;
            font-size: 12px;
            max-height: 200px;
            overflow-y: auto;
        }
    </style>
</head>
<body>
    <h1>ğŸ”§ Shadowverse Tracker åŠŸèƒ½è¨ºæ–·</h1>
    
    <div class="test-section">
        <h2>åŸºæœ¬åŠŸèƒ½æ¸¬è©¦</h2>
        <button onclick="testBasicClick()">æ¸¬è©¦åŸºæœ¬é»æ“Š</button>
        <button onclick="testAlert()">æ¸¬è©¦ Alert</button>
        <button onclick="testConsoleLog()">æ¸¬è©¦ Console.log</button>
        <div id="basicResult"></div>
    </div>

    <div class="test-section">
        <h2>JavaScript æ¨¡çµ„æ¸¬è©¦</h2>
        <button onclick="testModuleLoading()">æ¸¬è©¦æ¨¡çµ„è¼‰å…¥</button>
        <button onclick="testConfigLoad()">æ¸¬è©¦ CONFIG</button>
        <button onclick="testDataManager()">æ¸¬è©¦ DataManager</button>
        <div id="moduleResult"></div>
    </div>

    <div class="test-section">
        <h2>DOM æ“ä½œæ¸¬è©¦</h2>
        <button onclick="testDOMManipulation()">æ¸¬è©¦ DOM æ“ä½œ</button>
        <button onclick="testEventBinding()">æ¸¬è©¦äº‹ä»¶ç¶å®š</button>
        <div id="domResult"></div>
    </div>

    <div class="test-section">
        <h2>ä¸»æ‡‰ç”¨æ¸¬è©¦</h2>
        <button onclick="window.open('index.html', '_blank')">é–‹å•Ÿä¸»æ‡‰ç”¨ï¼ˆæ–°è¦–çª—ï¼‰</button>
        <button onclick="window.open('debug.html', '_blank')">é–‹å•Ÿèª¿è©¦é é¢</button>
        <button onclick="window.location.href='index.html'">åˆ‡æ›åˆ°ä¸»æ‡‰ç”¨</button>
    </div>

    <div class="test-section">
        <h2>æ§åˆ¶å°æ—¥èªŒ</h2>
        <div id="consoleLog" class="log"></div>
        <button onclick="clearLog()">æ¸…é™¤æ—¥èªŒ</button>
    </div>

    <!-- è¼‰å…¥ä¸»æ‡‰ç”¨çš„æ¨¡çµ„ä¾†æ¸¬è©¦ -->
    <script src="src/js/config.js"></script>
    <script src="src/js/data-manager.js"></script>
    <script src="src/js/rank-manager.js"></script>
    <script src="src/js/ui-controller.js"></script>

    <script>
        let logContainer = document.getElementById('consoleLog');
        
        // æ””æˆª console.log
        const originalLog = console.log;
        console.log = function(...args) {
            originalLog.apply(console, args);
            logToPage('LOG: ' + args.join(' '));
        };

        const originalError = console.error;
        console.error = function(...args) {
            originalError.apply(console, args);
            logToPage('ERROR: ' + args.join(' '), 'error');
        };

        function logToPage(message, type = 'success') {
            const div = document.createElement('div');
            div.className = type;
            div.textContent = new Date().toLocaleTimeString() + ' - ' + message;
            logContainer.appendChild(div);
            logContainer.scrollTop = logContainer.scrollHeight;
        }

        function updateResult(sectionId, message, type = 'success') {
            const element = document.getElementById(sectionId);
            const div = document.createElement('div');
            div.className = type;
            div.innerHTML = message;
            element.appendChild(div);
        }

        function clearLog() {
            logContainer.innerHTML = '';
        }

        // æ¸¬è©¦å‡½æ•¸
        function testBasicClick() {
            updateResult('basicResult', 'âœ… åŸºæœ¬é»æ“ŠåŠŸèƒ½æ­£å¸¸ï¼', 'success');
            console.log('åŸºæœ¬é»æ“Šæ¸¬è©¦æˆåŠŸ');
        }

        function testAlert() {
            alert('Alert åŠŸèƒ½æ­£å¸¸ï¼');
            updateResult('basicResult', 'âœ… Alert åŠŸèƒ½æ­£å¸¸ï¼', 'success');
        }

        function testConsoleLog() {
            console.log('é€™æ˜¯ä¸€å€‹æ¸¬è©¦æ—¥èªŒè¨Šæ¯');
            updateResult('basicResult', 'âœ… Console.log åŠŸèƒ½æ­£å¸¸ï¼', 'success');
        }

        function testModuleLoading() {
            try {
                // æ¸¬è©¦ CONFIG
                if (typeof CONFIG !== 'undefined') {
                    updateResult('moduleResult', 'âœ… CONFIG å·²è¼‰å…¥', 'success');
                } else {
                    updateResult('moduleResult', 'âŒ CONFIG æœªè¼‰å…¥', 'error');
                }

                // æ¸¬è©¦é¡åˆ¥
                if (typeof DataManager !== 'undefined') {
                    updateResult('moduleResult', 'âœ… DataManager é¡åˆ¥å·²è¼‰å…¥', 'success');
                } else {
                    updateResult('moduleResult', 'âŒ DataManager é¡åˆ¥æœªè¼‰å…¥', 'error');
                }

                if (typeof UIController !== 'undefined') {
                    updateResult('moduleResult', 'âœ… UIController é¡åˆ¥å·²è¼‰å…¥', 'success');
                } else {
                    updateResult('moduleResult', 'âŒ UIController é¡åˆ¥æœªè¼‰å…¥', 'error');
                }

            } catch (error) {
                updateResult('moduleResult', 'âŒ æ¨¡çµ„è¼‰å…¥éŒ¯èª¤: ' + error.message, 'error');
                console.error('æ¨¡çµ„è¼‰å…¥éŒ¯èª¤:', error);
            }
        }

        function testConfigLoad() {
            try {
                if (typeof CONFIG !== 'undefined') {
                    updateResult('moduleResult', 'âœ… CONFIG.STORAGE_KEYS: ' + JSON.stringify(CONFIG.STORAGE_KEYS), 'success');
                    updateResult('moduleResult', 'âœ… CONFIG.DEFAULTS: ' + JSON.stringify(CONFIG.DEFAULTS), 'success');
                } else {
                    updateResult('moduleResult', 'âŒ CONFIG ç„¡æ³•å­˜å–', 'error');
                }
            } catch (error) {
                updateResult('moduleResult', 'âŒ CONFIG æ¸¬è©¦éŒ¯èª¤: ' + error.message, 'error');
            }
        }

        function testDataManager() {
            try {
                const dm = new DataManager();
                updateResult('moduleResult', 'âœ… DataManager å»ºç«‹æˆåŠŸ', 'success');
                updateResult('moduleResult', 'ğŸ“Š ç©å®¶è³‡æ–™: ' + dm.playerData.name, 'success');
                updateResult('moduleResult', 'ğŸ† å°æˆ°è¨˜éŒ„: ' + dm.battleData.length + ' å ´', 'success');
            } catch (error) {
                updateResult('moduleResult', 'âŒ DataManager å»ºç«‹å¤±æ•—: ' + error.message, 'error');
                console.error('DataManager éŒ¯èª¤:', error);
            }
        }

        function testDOMManipulation() {
            try {
                // å‰µå»ºæ¸¬è©¦å…ƒç´ 
                const testDiv = document.createElement('div');
                testDiv.id = 'testElement';
                testDiv.textContent = 'é€™æ˜¯ä¸€å€‹æ¸¬è©¦å…ƒç´ ';
                testDiv.style.background = '#4caf50';
                testDiv.style.padding = '10px';
                testDiv.style.margin = '10px 0';
                testDiv.style.borderRadius = '5px';
                
                document.getElementById('domResult').appendChild(testDiv);
                updateResult('domResult', 'âœ… DOM æ“ä½œæˆåŠŸ', 'success');
                
                // 2ç§’å¾Œç§»é™¤
                setTimeout(() => {
                    if (document.getElementById('testElement')) {
                        document.getElementById('testElement').remove();
                        updateResult('domResult', 'âœ… DOM å…ƒç´ ç§»é™¤æˆåŠŸ', 'success');
                    }
                }, 2000);
                
            } catch (error) {
                updateResult('domResult', 'âŒ DOM æ“ä½œå¤±æ•—: ' + error.message, 'error');
            }
        }

        function testEventBinding() {
            try {
                const testBtn = document.createElement('button');
                testBtn.textContent = 'é»æˆ‘æ¸¬è©¦äº‹ä»¶';
                testBtn.onclick = function() {
                    this.textContent = 'äº‹ä»¶è§¸ç™¼æˆåŠŸï¼';
                    this.style.background = '#4caf50';
                    updateResult('domResult', 'âœ… äº‹ä»¶ç¶å®šæˆåŠŸ', 'success');
                };
                document.getElementById('domResult').appendChild(testBtn);
                updateResult('domResult', 'âœ… äº‹ä»¶ç¶å®šæ¸¬è©¦æŒ‰éˆ•å·²å»ºç«‹', 'warning');
            } catch (error) {
                updateResult('domResult', 'âŒ äº‹ä»¶ç¶å®šå¤±æ•—: ' + error.message, 'error');
            }
        }

        // é é¢è¼‰å…¥å®Œæˆå¾Œè‡ªå‹•åŸ·è¡ŒåŸºæœ¬æ¸¬è©¦
        document.addEventListener('DOMContentLoaded', function() {
            logToPage('é é¢è¼‰å…¥å®Œæˆï¼Œé–‹å§‹è‡ªå‹•è¨ºæ–·...');
            
            setTimeout(() => {
                testBasicClick();
                testModuleLoading();
                testConfigLoad();
            }, 500);
        });

        // æª¢æŸ¥å…¨åŸŸè®Šæ•¸
        window.addEventListener('load', function() {
            logToPage('æª¢æŸ¥å…¨åŸŸè®Šæ•¸...');
            
            if (typeof dataManager !== 'undefined') {
                logToPage('dataManager å…¨åŸŸè®Šæ•¸å­˜åœ¨');
            } else {
                logToPage('dataManager å…¨åŸŸè®Šæ•¸ä¸å­˜åœ¨', 'error');
            }
            
            if (typeof uiController !== 'undefined') {
                logToPage('uiController å…¨åŸŸè®Šæ•¸å­˜åœ¨');
            } else {
                logToPage('uiController å…¨åŸŸè®Šæ•¸ä¸å­˜åœ¨', 'error');
            }
        });
    </script>
</body>
</html>
